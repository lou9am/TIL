### 하둡의 특징
하둡은 대규모 분산 병렬 처리의 업계 표준인 `맵리듀스` 시스템과 분산 파일시스템인 `HDFS`을 핵심 구성요소로 갖는 플랫폼 기술이며, 아래와 같은 4가지 특징을 지닌다.

__1. 선형적인 성능과 용량 확장__  
__2. 고장 감내성 (데이터를 3중 복제)__  
__3. 핵심 비즈니스 로직에 집중 가능__  
__4. 풍부한 에코시스템__  

그 중, 하둡 에코시스템에는 아래와 같은 기술들이 있다.

|구분|기술|
|--|--|
|데이터 수집|Flume-NG, kafka|
|데이터 연동|Sqoop|
|분산 데이터베이스|Hbase|
|대용량 SQL 질의|Hive, Pig|
|실시간 SQL 질의|Impala, Tajo|
|워크플로우 관리|Oozie, Azkaban|

+ 대용량 질의 기술에는 `아파치 드릴`, `아파치 스팅거`, `샤크`, `아파치 타조`, `임팔라`, `호크`, `프레스토` 등이 있다.

### Sqoop
이 중 스쿱은, SQL to Hadoop의 약자로 HDFS과 데이터베이스간의 데이터 연동 솔루션으로 오라클, MySQL, PostgreSQL, 사이베이스 등 `JDBC`를 지원하는 대부분의 `관계형 데이터베이스와의 연동을 지원`한다.

---

### 분산 파일 시스템

1) GFS(Google File System) 
- 대규모 클러스터 서비스 플랫폼의 기반이 되는 파일 시스템
- 파일을 고정된 크기의 `청크`로 나누고, 각 청크에 대한 복제본을 여러 `청크서버`에 분산 저장한다.
- 여러 개의 `클라이언트`, 하나의 `마스터`, 여러 개의 `청크서버`로 구성되어 있다.

2) HDFS(Hadoop Distributed File System)
- 데이터는 블록(또는 청크)로 나누어 여러 `데이터 노드`에 분산 복제 저장한다.
- 낮은 데이터 접근 지연시간보다 높은 데이터 처리량에 중점을 둔다.
- 하나의 `네임노드`, `보조 네임노드`, 다수의 `데이터노드`로 구성된다.
- 네임노드는 모든 메타데이터를 관리한다. but 데이터를 저장하거나 어플리케이션을 실행하진 않는다. 
- 데이터노드는 데이터의 유실을 방지하기 위해 블록을 `3중 복제`하여 저장한다.
- `순차적 스트리밍 방식`으로 파일을 저장하거나 조회하며, `배치 작업`에 적합하도록 설계됐다.

3) 러스터(Luster)
- `객체 기반의 클러스터 파일 시스템`
- `클라이언트 파일 시스템`, `메타데이터 서버`, `객체 저장 서버`로 구성된다.
- 클라이언트에서 메타데이터 변경에 대한 갱신 레코드를 생성하고 나중에 메타데이터 서버에 전달한다.
- 파일의 메타데이터와 파일 데이터에 대한 동시성 제어를 위해 별도의 잠금을 사용한다.
- 메타데이터에 대한 잠금 요청시, 메타데이터 접근 의도를 같이 전달하는 인텐트(intent) 기반 잠금 프로그램을 사용한다.

---

### 데이터베이스 클러스터
하나의 데이터베이스를 여러 개의 서버(또는 가상 서버) 상에 구축하는 것.  
데이터를 통합할 때, 성능과 가용성의 향상을 위해 데이터베이스 차원의 `파티셔닝` 또는 `클러스터링`을 이용한다.

데이터베이스 파티셔닝을 구현할 경우, `병렬처리`, `고가용성`, `성능향상`을 도모할 수 있다.

#### 구분
데이터베이스 클러스터는 `무공유 디스크 방식`과 `공유 디스크 방식`으로 나뉜다.

이중, 무공유 디스크 방식은 노드가 완전히 분리되어 노드 확장에 제한이 없으나, 장애 발생을 대비해 `fault-toleranc`를 별도로 구성해야 한다.

__* fault tolerance__ : 시스템에 고장이 발생하더라도 모든 기능 혹은 일부 기능을 기존과 동일하게 유지하는 기술.  

공유 디스크 방식은 모든 노드가 파일을 공유하기 때문에 `SAN(Storage Area Network)`과 같은 네트워크가 필수이며, 대표적인 공유 디스크 방식에는 `Oracle RAC`가 있다.  
장점으로는 높은 수준의 폴트 톨러런스를 제공하고, 단점으로는 클러스터가 커지면 디스크 영역에서 병목현상이 발생한다는 것이다.

__* Oracle RAC__ : Oracle Real Application Cluster


#### 데이터베이스 클러스터의 종류

1. Oracle RAC(Real Application Cluster) 데이터베이스 서버
- 공유 클러스터 (공유 디스크 방식)  
- __장점__
> 1. 가용성 : 높은 수준의 fault-tolerance를 제공
> 2. 확장성 : 추가 처리 성능 필요 시 응용 프로그램이나 데이터베이스를 수정할 필요 없이 새 노드를 클러스터에 쉽게 추가할 수 있다.
> 3. 비용 절감 : 저가형 상용 하드웨어의 클러스터에서도 고가의 SMP 시스템만큼 효율적으로 응용 프로그램을 실행.

2. IBM DB2 ICE(Integrated Cluster Environment)
- 무공유 방식의 클러스터링
- 파티셔닝을 어떻게 구성하느냐에 따라 성능의 차이가 많이 발생할 수 있다.
- 하나의 노드에 장애가 발생할 경우, 별도의 `페일오버` 메커니즘이 필요하므로, DB2를 이용하여 클러스터링을 구성할 때는 공유 디스크 방식을 사용해 가용성을 보장한다.

__* 페일오버__ : 데이터베이스의 최신 버전을 백업해두어, 1차 시스템에 장애가 발생하였을 경우 대체 시스템을 작동시켜 장애를 극복하는 기능

3. 마이크로소프트 SQL Server
- 연합 데이터베이스 형태
- 연합 데이터베이스는 디스크 등을 공유하지 않는 독립된 서버에서 실행되는 서로 다른 데이터베이스들 간의 논리적인 결합이며, 네트워크를 이용하여 연결한다.
- 페일오버 메커니즘을 제공하지만, Active-Active가 아닌 Active-Standby 방법을 사용한다.

4. MySQL
- 비공유형으로서 메모리 기반 데이터베이스의 클러스터링을 지원한다. (최근에는 디스크도 제공한다.)
- 특정한 하드웨어 및 소프트웨어를 요구하지 않고 병렬 서버구조로 확장이 가능하다.
- 관리 노드, 데이터 노드, MySQL 노드로 구성된다.  

|노드|설명|
|--|--|
|관리 노드|클러스터를 관리하는 노드, 클러스터 시작과 재구성 시에만 관여한다.|
|데이터 노드|클러스터의 데이터를 저장|
|MySQL 노드|클러스터 데이터에 접근을 지원|

- 데이터의 가용성을 높이기 위해 데이터를 다른 노드에 복제시킨다.

__MySQL 클러스터를 구성할 경우 제한 사항__
1. 클러스터에 참여하는 노드는 255로 제한한다. 이중, 데이터 노드는 최대 48개까지만 가능하다.
- 트랜잭션 수행 중에 롤백을 지원하지 않으므로 작업 수행 중에 문제가 발생했을 경우 전체 트랜잭션 이전으로 롤백해야 한다.
- 하나의 트랜잭션에 많은 데이터를 처리하는 경우 메모리 부족 문제가 발생할 수 있으며 여러 개의 트랜잭션으로 분리해 처리하는 것이 좋다.
- 운영 중에 노드를 추가/삭제할 수 없다.
- 모든 클러스터의 기종은 동일해야 한다.


