# 1과목 데이터 모델링의 이해
(유선배 SQL 개발자, SQL 자격검정 실전문제 문제집을 바탕으로 정리)  
<br>

## 모델링이란?
- 데이터베이스의 모델링은 '현실 세계를 단순화하여 표현하는 기법'이다.
- 정보시스템을 구축하기 위한 데이터 관점의 업무 분석 기법이다.
- 현실세계의 데이터에 대해 약속된 표기법에 의해 표현하는 과정이다.
- 데이터베이스를 구축하기 위한 분석/설계의 과정이다.

### 모델링이 갖춰야 할 조건
1) 현실세계를 반영해야 한다.
2) 단순화하여 표현해야 한다.
3) 관리하고자 하는 데이터를 모델로 설계한다.

### 모델링의 특징
1. 추상화(Abstraction) : 아이디어나 개념을 간략하게 표현하는 과정
2. 단순화(Simplification) : 복잡한 현실 세계를 정해진 표기법으로 단순하고 쉽게 표현
3. 명확화(Clarity) : 불분명함을 제거하고 명확하게 해석할 수 있도록 기술

### 모델링의 세 가지 관점
1. 데이터 관점 (What) : 어떤 데이터들이 업무와 얽혀있는지, 그 데이터 간에는 어떤 관계가 있는지
2. 프로세스 관점 (How) : 이 업무가 실제로 처리하고 있는 일은 무엇인지, 앞으로 처리해야 하는 일은 무엇인지
3. 데이터와 프로세스의 상관 관점 (Data vs. Process) : 데이터와 프로세스의 관계를 위주로 한 모델링. 프로세스의 흐름에 따라 데이터가 어떤 영향을 받는지 모델링

### 모델링의 세 가지 단계
1. 개념적 데이터 모델링 : 전사적 데이터 모델링 수행 시 행해지며 추상화 레벨이 가장 높은 모델. 업무 중심적이고 포괄적인 수준의 모델링 진행
2. 논리적 데이터 모델링 : 재사용성이 가장 높은 모델링. 데이터베이스 모델에 대한 key, 속성, 관계 등을 표현하는 단계
3. 물리적 데이터 모델링 : 실제 데이터베이스로 구현할 수 있도록 성능이나 가용성 등의 물리적인 성격을 고려하여 모델을 표현하는 단계

### 데이터 모델링의 유의사항
1. 중복(Duplication) : 같은 데이터가 여러 엔터티에 중복으로 저장되는 현상을 지양해야 한다.
2. 비유연성(Inflexibility) : 데이터 모델과 프로세스를 분리하여 유연성을 높인다. 어플리케이션의 사소한 변경에도 데이터 모델이 수시로 변경되어야 하는 경우, 시스템을 유지보수하는 데에 어려움을 가중시키므로 분리하는 것이 바람직하다.
3. 비일관성 : 데이터의 중복이 없는 경우에도 발생할 수 있다. 데이터 모델링을 할 때 데이터 간의 일관성을 유지하기 위해 상호 연관 관계에 대해 명확하게 정의해야 한다.

### 데이터 모델링 순서
1. 데이터 정규화
2. 데이터 용량 및 트랜잭션 유형 파악
3. 반정규화 수행
4. PK/FK 조정, 슈퍼/서브타입 조정
5. 데이터 모델 성능 검증

### 데이터 모델 이상현상
1. 삽입 이상 : 가짜 PK를 만들어야 함
2. 갱신 이상 : 일부만 업데이트 됨
3. 삭제 이상 : 삭제되면 안 되는 데이터 같이 삭제

---

### ANSI-SPARC 아키텍처
ANSI-SPARC 아키텍처는 스키마를 `3단계 구조`로 나눈다. 이렇게 분리하는 목적은 데이터베이스에 대한 사용자들의 관점과 데이터베이스가 실제로 표현되는 물리적인 방식을 분리하여 데이터의 독립성을 보장하기 위함이다.  

### 데이터의 독립성이란?  
사용자 입장에서는 필요한 데이터만 볼 수 있으면 되고 데이터베이스의 내부 구조에 대해서는 굳이 알 필요가 없다. 마찬가지로 DBA의 입장에서는 어플리케이션에 영향을 주지 않고 데이터베이스의 구조를 변경할 수 있어야 독립성이 보장된다고 할 수 있다. 3단계 스키마 구조를 사용하면 다음과 같은 독립성을 보장할 수 있다.   

- 논리적 독립성 : 개념 스키마가 변경되어도 외부 스키마는 영향받지 않는다.
- 물리적 독립성 : 내부 스키마가 변경되어도 외부/개념 스키마는 영향받지 않는다.

### 3단계 스키마 구조
1. 외부 스키마 : 사용자의 관점. 각 사용자가 보는 데이터베이스의 스키마를 정의한다.
2. 개념 스키마 : 통합된 관점. 모든 사용자가 보는 데이터베이스의 스키마를 통합하여 전체 데이터베이스를 나타내는 것이다.
3. 내부 스키마 : 물리적인 관점. 실질적인 데이터의 저장 구조나 컬럼 정의, 인덱스 등이 포함된다.

---

### ERD(Entity Relationship Diagram)
- 시스템에 어떤 엔터티들이 존재하며 그들 간에 어떤 관계가 있는지를 나타내는 다이어그램.
- ERD는 존재에 의한 관계와 행위에 의한 관계를 구분하지 않는다. (클래스 다이어그램에서는 연관관계와 의존관계로 구분하여 표현한다.)

### ERD 표기 방식
1. Peter Chen : 주로 대학교재에서 사용하는 표기법. 실무에서 사용하는 경우는 드물다.
2. IDEF1X : 실무에서 사용하는 경우도 있으며 ERWin에서 사용되는 모델
3. IE/Crow's Foot : 가장 많이 사용되며 ERWin, ERStudio에서 사용되는 모델.
4. Min-Max/ISO : 각 엔터티의 참여도를 좀 더 상세하게 나타내는 표기법
5. UML : 소프트웨어 공학에서 주로 사용
6. Case*Method/Barker : Oracle에서 사용되는 모델

---

## 엔터티(Entity)
데이터베이스에서 엔터티는 식별이 가능한 객체라는 의미를 가진다. 즉, 엔터티는 업무에서 쓰이는 데이터를 용돕려로 분류한 그룹이다.
(참고로 엔터티 : Table, 인스턴스 : Row, 속성 : Column)

### 엔터티의 특징
1. 업무에서 쓰이는 정보여야 함
2. 유니크함을 보장할 수 있는 식별자가 있어야 함
3. 2개 이상의 인스턴스를 가지고 있어야 함
4. 반드시 속성을 가지고 있어야 함
5. 다른 엔터티와 1개 이상의 관계를 가지고 있어야 함

### 엔터티의 분류
1. 유형 vs. 무형
- 유형 엔터티 : 물리적인 형태 존재, 안정적, 지속적
예) 상품, 회원
- 개념 엔터티 : 물리적인 형태 없음, 개념적
예) 부서, 학과
- 사건 엔터티 : 행위를 함으로써 발생, 빈번함, 통계 자료로 이용 가능
예) 주문, 이벤트 응모

2. 발생시점
- 기본 엔터티 : 독립적으로 생성됨. 자식 엔터티를 가질 수 있음.
예) 상품, 회원
- 중심 엔터티 : 기본 엔터티로부터 파생. 행위 엔터티 생성
예) 주문
- 행위 엔터티 : 2개 이상의 엔터티로부터 파생
예) 주문 내역, 이벤트 응모 이력

### 엔터티의 이름을 정할 때 주의할 점
- 업무에서 실제로 쓰이는 용어 사용
- 한글은 약어를 사용하지 않고 영문은 대문자로 표기
- 단수 명사로 표현하고 띄어쓰기는 하지 않음
- 다른 엔터티와 의미상으로 중복될 수 없음(주문, 결제 엔터티는 중복될 수 있음)
- 해당 엔터티가 갖고 있는 데이터가 무엇인지 명확하게 표현

<br>

## 속성(Attribute)
속성이란, 엔터티의 특징을 나타내는 최소의 데이터 단위이다. 속성은 의미상 더 이상 쪼개지지 않는 레벨이어야 하고 프로세스에 필요한 항목이어야 한다.
각각의 속성은 속성값을 가지며 속성값은 엔터티에 속한 하나의 인스턴스를 구체적으로 나타내주는 데이터라고 볼 수 있다. 하나의 속성은 한 개의 속성값만 가질 수 있다. 만약 속성값이 여러 개일 경우 별도의 엔터티로 분리하는 것이 바람직하다.

### 엔터티, 인스턴스, 속성, 속성값의 관계
- 한 개의 엔터티는 2개 이상의 인스턴스를 갖는다.
- 한 개의 엔터티(인스턴스)는 2개 이상의 속성을 갖는다.
- 한 개의 속성은 1개의 속성값을 갖는다.

### 속성의 분류
1. 특성에 따른 분류
- 기본속성 : 업무 프로세스 분석을 통해 바로 정의가 가능한 속성
- 설계속성 : 업무에 존재하지는 않지만 설계하다 보니 필요하다고 판단되어 도출해낸 속성
- 파생속성 : 다른 속성의 속성값을 계산하거나 특정한 규칙으로 변형하여 생성한 속성

2. 구성방식에 따른 분류
- PK(Primary Key) 속성 : 엔터티의 인스턴스들을 식별할 수 있는 속성
- FK(Foreigh Key) 속성 : 다른 엔터티의 속성에서 가져온 속성
- 일반속성 : PK, FK를 제외한 나머지 속성

<br>

## 도메인
속성이 가질 수 있는 속성값의 범위. 속성에 대한 데이터 타입과 제약사항을 지정한다.

## 용어사전
하나의 데이터베이스에서 같은 의미를 가진 데이터가 엔터티마다 다른 명의로 정의된다면 자칫 혼란을 초래할 수 있다. 이런 현상을 방지하기 위해 설계 시 용어사전을 두고 각 엔터티에 공통된 룰로 적용하는 것이 바람직하다.

## 관계
엔터티와 엔터티와의 관계를 의미한다. 어떠한 연관성이 있는지 타입을 분류하여 존재 관계와 행위 관계로 나눌 수 있다.
- 존재 관계 : 부모와 자식처럼 존재 자체로 연관성이 있는 관계. 예) 직원과 부서, 학생과 학과
- 행위 관계 : 특정한 행위를 함으로써 연관성이 생기는 관계. 예) 회원과 주문, 학생과 출석부

### 엔터티 간의 관계 표기법
1. 관계명 : 관계의 이름
- 모든 관계는 각 엔터티의 관점에서 관계명을 하나씩 가지기 때문에 총 두 개의 관계명을 갖는다.
- 관계명은 반드시 명확한 문장으로 표현해야 하며 현재형이어야 한다.
2. 관계차수 : 관계에 참여하는 수
- 1:1, 1:M, M:N 형식으로 구분된다.
3. 관계선택사양 : 필수인지 선택인지의 여부

<br>

## 식별자(Identifiers)
식별자란, 속성 중에서 각각의 인스턴스를 구분 가능하게 만들어주는 대표 격인 속성을 의미한다.

### 주식별자
- 주식별자는 기본키, PK에 해당하는 속성이다. 하나일 수도 있고, 여러 개일수도 있다.

### 주식별자의 특징
1. 유일성 : 각 인스턴스에 유니크함을 부여하여 식별이 가능하도록 함.
- 이름 같은 건 동명이인이 존재할 수 있으므로 유일성 X
2. 최소성 : 유일성을 보장하는 최소 개수의 속성이어야 한다.
3. 불변성 : 속성값이 되도록 변하지 않아야 한다.
4. 존재성 : 속성값이 NULL일 수 없다.

### 분류
식별자를 분류하는 방식에는 4가지가 있다.

1. 대표성 여부
- 주식별자 : 다른 엔터티와 참조 관계로 연결
- 보조식별자 : 다른 엔터티와 참조 관계로 연결되지 않음

2. 스스로 생성되었는지 여부
- 내부식별자 : 엔터티 내부에서 스스로 생성
- 외부식별자 : 다른 엔터티에서 온 식별자

3. 단일 속성의 여부
- 단일식별자 : 하나의 속성으로 구성된 식별자
- 복합식별자 : 두 개 이상의 속성으로 구성된 식별자

4. 대체 여부
- 원조식별자 : 업무 프로세스에 존재하는 식별자. 가공되지 않은 원래의 식별자(본질식별자)
- 대리식별자 : 주식별자의 속성이 2개 이상인 경우 그 속성들을 하나로 묶어서 사용하는 식별자(인조식별자)

### 식별자 관계 vs. 비식별자 관계
1. 식별자 관계 (강한 관계)
- 부모 엔터티의 식별자가 자식 엔터티의 `주식별자`가 되는 관계.
- 주식별자는 반드시 존재해야 하므로 부모 엔터티가 있어야 생성 가능.
- 단일식별자인지 복합식별자인지에 따라 1:1이거나 1:M이거나가 결정된다.
- ERD에서 실선으로 표현.

2. 비식별자 관계 (약한 관계)
- 부모 엔터티의 식별자가 자식 엔터티의 `일반 속성`이 되는 관계.
- 일반 속성의 속성값은 NULL이 될 수 있으므로 부모 엔터티가 없는 자식 엔터티 생성이 가능하다.
- 마찬가지의 이유로 자식 엔터티가 존재하는 상태에서 부모 엔터티가 삭제될 수 있다.
- ERD에서 점선으로 표현
